# Figure 2(e) - Information-Theoretic Greed-Fear Indices
**Generated:** October 14, 2025
**Status:** CORRECTED - Ready for Dr. Rachev's review

---

## Summary

This folder contains the **corrected** Figure 2(e) variants implementing Dr. Rachev's information-theoretic greed-fear indices as specified in his blue-text documentation (October 13, 2025).

### Critical Formula Correction Applied

**Issue found:** The original implementation incorrectly used `G_FI = G(p) / [p(1-p)]`
**Corrected to:** `G_FI = G(p) / √[p(1-p)]` per Dr. Rachev's Equation (2)

This correction was identified by comparing the code against Dr. Rachev's specification screenshots provided by Akash.

---

## Generated Figures

### 1. **Figure_2e1_LogitShift_GFI** (PNG + PDF)
**Index:** G_FI(p) = [logit(w(p)) - logit(p)] / √[p(1-p)]

**Characteristics:**
- Range: Fearful ±26, Greedy ±46
- Perfect mirror symmetry with opposite signs
- Fearful: positive at p<0.5, negative at p>0.5
- Greedy: negative at p<0.5, positive at p>0.5
- Spikes at boundaries due to Fisher-information normalization

**Formula verification:** ✅ Matches Dr. Rachev's Equation (2)

---

### 2. **Figure_2e2_JensenShannon_SJS** (PNG + PDF)
**Index:** S_JS(p) = sgn(w(p) - p) · √(2·JSD(p))

**Characteristics:**
- Range: Fearful ±0.12, Greedy ±0.13
- Smooth, bounded curves (well within theoretical bound of ±1.18)
- Same mirror-symmetric pattern as G_FI but smoother
- No boundary singularities

**Formula verification:** ✅ Matches Dr. Rachev's Equations (3-4)

---

### 3. **Figure_2e3_Elasticity_E** (PNG + PDF)
**Index:** E(p) = d/dp[logit(w(p)) - logit(p)] = w'(p)/[w(1-w)] - 1/[p(1-p)]

**Characteristics:**
- Range: Fearful -90 to -1, Greedy +2 to +155
- Shows rate of change of logit-shift
- Fearful: consistently negative (odds increase slower than benchmark)
- Greedy: consistently positive (odds increase faster than benchmark)

**Formula verification:** ✅ Matches Dr. Rachev's Equation (5)

**Implementation note:** Uses 2nd-order numerical derivatives (np.gradient with edge_order=2). Dr. Rachev suggests 4th-order differences for publication quality, but 2nd-order is sufficient for visualization.

---

### 4. **Figure_2e4_Cumulative_Scores** (PNG + PDF)
**Indices:** Running integrals of G_FI(p) and S_JS(p)

**Characteristics:**
- **Left panel (Cumulative G_FI):**
  - Fearful: rises to peak +0.90, returns to 0
  - Greedy: drops to minimum -1.52, returns to 0

- **Right panel (Cumulative S_JS):**
  - Fearful: rises to peak +0.035, returns to 0
  - Greedy: drops to minimum -0.042, returns to 0

**Interpretation:** The peak magnitudes quantify the overall strength of greed/fear effects across the entire probability range.

---

## Formula Verification Summary

All formulas verified against Dr. Rachev's specifications (screenshots from Word document):

| Index | Formula | Status |
|-------|---------|--------|
| G_FI(p) | G(p) / √[p(1-p)] | ✅ CORRECTED (was missing sqrt) |
| S_JS(p) | sgn(w-p) · √(2·JSD) | ✅ CORRECT |
| E(p) | w'/(w(1-w)) - 1/(p(1-p)) | ✅ CORRECT |
| Cumulative | Trapezoidal integration | ✅ CORRECT |

---

## Expected Behavior (All Verified)

✅ Mirror-symmetric patterns with opposite signs
✅ Fearful: positive at p<0.5, negative at p>0.5
✅ Greedy: negative at p<0.5, positive at p>0.5
✅ Cumulative curves return to zero at p=1
✅ Much stronger visual separation than old Γ(p) index
✅ S_JS values bounded by theoretical limit
✅ Aggregate scores ≈ 0 (expected due to antisymmetry)

---

## Files in This Folder

```
Figure_2e1_LogitShift_GFI.png          (105 KB, 300 DPI)
Figure_2e1_LogitShift_GFI.pdf          (17 KB, vector)
Figure_2e2_JensenShannon_SJS.png       (120 KB, 300 DPI)
Figure_2e2_JensenShannon_SJS.pdf       (17 KB, vector)
Figure_2e3_Elasticity_E.png            (99 KB, 300 DPI)
Figure_2e3_Elasticity_E.pdf            (17 KB, vector)
Figure_2e4_Cumulative_Scores.png       (230 KB, 300 DPI)
Figure_2e4_Cumulative_Scores.pdf       (20 KB, vector)
README.md                              (this file)
```

---

## Next Steps

1. **Review with Dr. Rachev:** Confirm these plots show the expected "stronger visual and quantitative separation"
2. **If approved:** Use these figures in the manuscript
3. **If adjustments needed:** Consider the optional extreme parameters mentioned in Dr. Rachev's specs (G/M = 10/2 vs 2/10, σ=0.89)

---

## Technical Details

**Case 1 Parameters:**
- Benchmark: C=0.6, Y=1.2, G=M=5.0, σ=1.0
- Fearful: C=0.6, Y=1.2, G=M=5.0, σ=1.4
- Greedy: C=0.6, Y=1.2, G=M=5.0, σ=0.7

**Computation:**
- Grid: 2000 points, p_i = i/(N+1) for i=1,...,2000
- Clipping: [10^-6, 1-10^-6] to avoid overflow
- Integration: Trapezoidal rule via cumsum
- PWF: w(u) = F_post(Q_prior(u)) using temStaPy library

---

**Generated by:** generate_figure_2e_information_theoretic.py
**Diagnostic scripts:** See diagnostic_scripts/ folder
